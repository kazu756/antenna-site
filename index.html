<!DOCTYPE html><html lang="ja">
<head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MyRSS„Åæ„Å®„ÇÅ</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2/dist/tailwind.min.css" rel="stylesheet"></head>
<body class="bg-gray-50 text-gray-800">

  <!-- „Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫ÂàáÊõø -->
  <div class="text-right p-4">
    <button onclick="setFontSize('text-xs')" class="px-2 py-1">Ê•µÂ∞è</button>
    <button onclick="setFontSize('text-sm')" class="px-2 py-1">Â∞è</button>
    <button onclick="setFontSize('text-base')" class="px-2 py-1">‰∏≠</button>
    <button onclick="setFontSize('text-lg')" class="px-2 py-1">Â§ß</button>
  </div>

  <!-- „Éò„ÉÉ„ÉÄ„Éº„Éª„Éí„Éº„É≠„ÉºÁúÅÁï•ÂèØÔºàÂâçÂõû„Ç≥„Éº„ÉâÂèÇÁÖßÔºâ -->

  <main class="container mx-auto py-8 px-4">
    <div id="feed"></div>
  </main>

  <script src="https://unpkg.com/rss-parser/dist/rss-parser.min.js"></script>
  <script>
    function setFontSize(cls){
      const h=document.documentElement;
      ['text-xs','text-sm','text-base','text-lg'].forEach(c=>h.classList.remove(c));
      h.classList.add(cls); localStorage.setItem('fontSize', cls);
    }
    window.addEventListener('load', ()=>{
      const cls=localStorage.getItem('fontSize')||'text-sm';
      document.documentElement.classList.add(cls);
    });

    function toggleRead(link){
      const r=JSON.parse(localStorage.getItem('read')||'[]');
      const i=r.indexOf(link);
      i>-1?r.splice(i,1):r.push(link);
      localStorage.setItem('read', JSON.stringify(r));
    }
    function isRead(link){
      return JSON.parse(localStorage.getItem('read')||'[]').includes(link);
    }

    const parser=new RSSParser(), CORS="https://api.allorigins.win/get?url=";
    const feeds={
      "NHK„Éã„É•„Éº„Çπ":"https://www3.nhk.or.jp/rss/news/cat0.xml",
      "IT„Éª„ÉÜ„ÇØ„Éé„É≠„Ç∏„Éº":"https://rss.itmedia.co.jp/rss/2.0/news_bursts.xml"
    };

    async function fetchAndRender(){
      const root=document.getElementById("feed");
      root.innerHTML="";
      for(const [cat, url] of Object.entries(feeds)){
        const sect=document.createElement('section');
        sect.className="mb-8";
        sect.innerHTML=`
          <h2 class="text-xl font-bold mb-2">üìÅ ${cat}</h2>
          <p class="text-sm text-gray-600 mb-4">${url}</p>`;
        const list=document.createElement('ul');
        list.className="space-y-2";
        const data=await fetch(CORS+encodeURIComponent(url)).then(r=>r.json());
        const feed=await new Promise((res,rej)=>parser.parseString(data.contents,(e,f)=>e?rej(e):res(f)));
        feed.items.slice(0,8).forEach(item=>{
          const read=isRead(item.link);
          const li=document.createElement('li');
          li.className=`bg-white rounded-lg shadow px-4 py-3 flex justify-between items-start ${read?'opacity-50':''}`;
          li.innerHTML=`
            <div>
              <h3 class="font-medium ${read?'line-through':''}">${item.title}</h3>
              <p class="text-gray-500 text-xs">${new Date(item.pubDate).toLocaleString()}</p>
              <a href="${item.link}" target="_blank" class="text-blue-600 hover:underline text-xs">Á∂ö„Åç„ÇíË™≠„ÇÄ</a>
            </div>
            <button onclick="toggleRead('${item.link}');fetchAndRender()"
               class="text-xs text-gray-700">
               ${read?'Êó¢Ë™≠Ëß£Èô§':'‚úî Êó¢Ë™≠'}
            </button>`;
          list.appendChild(li);
        });
        sect.appendChild(list);
        root.appendChild(sect);
      }
    }

    fetchAndRender();
    setInterval(fetchAndRender,5*60*1000);
  </script>
</body></html>
